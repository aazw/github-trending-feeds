# github-trending-feeds

English | [日本語](README_ja.md)

## Overview

Scrapes GitHub Trending pages and provides **ATOM** feeds that can be read by RSS readers (such as Inoreader).

Data Source:  
GitHub Trending: https://github.com/trending

Publication:  
GitHub Pages: https://aazw.github.io/github-trending-feeds-data/

## Related Repositories

### https://github.com/aazw/github-trending-feeds 

- This repository
- Manages scripts that scrape GitHub Trending pages and generate ATOM feeds
- Runs the above scripts with GitHub Actions to generate ATOM feeds

### https://github.com/aazw/github-trending-feeds-data 

- Manages ATOM feeds generated by GitHub Actions in the above repository

## GitHub Actions

GitHub Actions schedule retrieves the latest trending information for each language.  

Based on various websites and Internet Archive history, GitHub Trends appears to update around 10:00-11:00 UTC.  
https://web.archive.org/web/20250000000000*/https://github.com/trending

Based on this information, Cron Jobs are executed on the following schedule.

### Cron Jobs

* Daily
  * Every day at 15:00 UTC
    * = 24:00 JST
  * Why not 11:00?
    * There's no guarantee it will always be updated by 11:00, it might be after 11:00
    * 10:00 UTC = 20:00 JST, which is close to midnight, so we decided to run it when the date changes

* Weekly
  * Every Monday at 16:00 UTC
    * = 25:00 JST
  * 16:00 UTC is to avoid overlapping with Daily processing

* Monthly
  * 1st of every month at 17:00 UTC
    * = 26:00 JST
  * 17:00 UTC is to avoid overlapping with Daily and sometimes Weekly processing


## Usage

### Setup Runtime Environment

```bash
task uv_sync
```

### Execute Scraping

```bash
uv run src/scrape_trending.py \
      --language   go \
      --period daily \
      --output     ./daily.atom
```

Help command example.

```bash
$ uv run src/scrape_trending.py --help
2024-12-26 14:20:01,055 - /workspaces/github-trending-feeds/src/scrape_trending.py:176 - INFO - start app
Usage: scrape_trending.py [OPTIONS]

Options:
  --language TEXT                 [required]
  --period [daily|weekly|monthly]
                                  [required]
  --output TEXT
  --atom_updated_date TEXT
  --verbose
  --help                          Show this message and exit.
2024-12-26 14:20:01,056 - /workspaces/github-trending-feeds/src/scrape_trending.py:194 - INFO - app finished
```

You can also override the ATOM date and time.

```bash
$ uv run src/scrape_trending.py --language go --period "daily" --atom-updated-date "$(date -I)T00:00:00" --output test.atom
```

### Scan all past ATOMs and create a list of repository URLs that appeared in the past

```bash
$ uv run src/unique_list.py --dir docs/feeds --output urls.txt
```

* `--dir`
  * Directory to scan
  * Scans *.atom files including subdirectories
  * Usually the `docs` directory
* `--output`
  * Output destination for the complete URL list

### Get a list of URLs for repositories that haven't appeared before in the specified ATOM

```bash
$ uv run src/new_arrivals.py --atom docs/feeds/go/daily.atom --urls urls.txt

$ uv run src/new_arrivals.py --atom docs/feeds/go/daily.atom --urls urls.txt --format atom

$ uv run src/new_arrivals.py --atom docs/feeds/go/daily.atom --urls urls.txt --format atom --output docs/new-arrivals/go/daily.atom
```

* `--atom`
  * ATOM to check
* `--urls`
  * Complete list of past URLs
* `--format`
  * `--format=plain`: Output only URL list
  * `--format=atom`: Output ATOM with only new URLs
* `--output`
  * Output file path
  * Only outputs to file when specified
  * Outputs to standard output when not specified

### Return Code / Exit Status

* `-1`: Unknown Error
* `0`: Normal termination
* `11`: InvalidURL
* `12`: ConnectionError
* `13`: Timeout related (Timeout, ConnectTimeout, ReadTimeout)
* `14`: TooManyRedirects
* `15`: Status code 400s
* `16`: Status code 500s
* `17`: Status codes other than 400s and 500s
* `18`: Other requests-related errors
* `31`: FileNotFoundError
* `32`: IsADirectoryError
* `33`: PermissionError
* `34`: OSError
